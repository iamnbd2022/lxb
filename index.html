<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
        <meta host="lxb.ian">
		<title>LXB</title>
                <javascript>const ian={endpointServers:["https://iamnbd2022.github.io/iandns/"],currentEndpointServer:"",currentHost:"",endpoints:[],loadHost:()=>{if(!ian.currentHost){var metas=document.getElementsByTagName("meta");for(let i=0;i<metas.length;i++)if(metas[i].hasAttribute("host")){ian.currentHost=metas[i].getAttribute("host");break}}return ian.currentHost},loadEndpointServers:()=>!(!ian.endpointServers||!ian.endpointServers.length)&&(ian.currentEndpointServer=ian.endpointServers.find(ep=>ian.isWorking(ep,"ping.txt")),null!=ian.currentEndpointServer),isWorking:(url,suffix)=>{url+=suffix||"/_health_";return"pong"===ian.getObject(url,!1)},loadIndex:url=>(url+="/index.js?ian-host="+ian.loadHost(),ian.loadJs(url),!0),loadJs:url=>{var tag=document.createElement("script");tag.src=url,document.getElementsByTagName("head")[0].appendChild(tag)},selectServer:()=>{},getJson:path=>{path=ian.findServerUrl()+"/"+path;return ian.getObject(path,!0)},getObject:(url,isJson)=>{var xmlHttp=new XMLHttpRequest;return url&&(url+="?ian-host="+ian.loadHost()),xmlHttp.open("GET",url,!1),xmlHttp.send(null),399<xmlHttp.status?(console.error(`Failed to send request to url[${url}] with status code[${xmlHttp.status} and message:`+xmlHttp.responseText),null):isJson?JSON.parse(xmlHttp.responseText):xmlHttp.responseText},findServerUrl:()=>{if(!ian.currentEndpointServer&&!ian.loadEndpointServers())return console.warn("No available endpoint server"),null;var esUrl=ian.currentEndpointServer+ian.loadHost()+".json",esUrl=ian.getObject(esUrl,!0),mainEp=esUrl.mainEndPoint;if(mainEp&&ian.isWorking(mainEp))return ian.endpoints.push(mainEp),mainEp;mainEp=esUrl.endpoints;if(mainEp){ian.endpoints=ian.endpoints.concat(mainEp);for(var item of mainEp){item=item.endpoint;if(ian.isWorking(item))return item;console.error("Cannot connect to endpoint:",item)}}},boot:()=>{var endpoint=ian.findServerUrl();null!=endpoint&&(console.info("Connecting to endpoint:",endpoint),ian.loadIndex(endpoint))},reload:host=>{ian.currentHost=host,ian.boot()},injectImgs:doc=>{var imgs=document.getElementsByTagName("img");if(imgs)for(var img of imgs)ian.injectImg(img)},injectImg:imgTag=>{imgTag&&(imgTag.onerror=event=>{let src=imgTag.originalSrc||imgTag.src;if(src.startsWith(document.location.origin)&&(src=src.substring(document.location.origin.length)),imgTag.complete&&0==imgTag.naturalHeight&&src&&src.length&&"/"==src.substring(0,1)){for(var ep of ian.endpoints)if(ian.isWorking(ep.endpoint)){imgTag.src=ep.endpoint+src+"?ian-host="+ian.loadHost();break}imgTag.originalSrc=src}})}};window&&ian&&(window.ian=ian),ian.boot();
</javascript>
	</head>
	<body class="" id="content">

	</body>
</html>
